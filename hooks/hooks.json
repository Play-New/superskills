{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Security check. Respond immediately. Check if this command is safe: $ARGUMENTS. Look for: hardcoded secrets, rm -rf, SQL injection via shell, exposure of sensitive data. Respond {\"ok\": true} if safe, {\"ok\": false, \"reason\": \"...\"} if dangerous. No explanation.",
            "timeout": 15
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Security gate. Respond immediately. Check this file change for: hardcoded API keys or secrets, SQL injection, XSS, auth bypass, PII in logs or URLs. $ARGUMENTS. Respond {\"ok\": true} if safe, {\"ok\": false, \"reason\": \"...\"} if a blocking issue is found. Only block on clear violations, not potential issues. No explanation.",
            "timeout": 15
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "agent",
            "prompt": "Test verification.\n\nFirst check: does CLAUDE.md exist in the project root? If not, respond {\"ok\": true} and stop — this project has not been configured with SuperSkills.\n\nSecond check: does package.json have a test script? Are there test files (*.test.*, *.spec.*, tests/, __tests__/)? If neither, respond {\"ok\": true} and stop — no tests to run.\n\nIf both checks pass, run `npm test`. If Playwright tests exist in tests/e2e/, run `npx playwright test` too.\n\nWrite results to `.superskills/report.md` — REPLACE the \"## Test Report\" section. Keep the last 3 runs for trend visibility, drop older entries. Update status counts at the top of report.md.\n\n**Date:** [date] | **Passed:** [count] | **Failed:** [count] | **Skipped:** [count]\n[failure details if any]\n\nGate: if tests fail, respond {\"ok\": false, \"reason\": \"X tests failing: [details]\"}. If tests pass, respond {\"ok\": true}.",
            "timeout": 60
          },
          {
            "type": "agent",
            "prompt": "Pre-stop audit.\n\nFirst check: does CLAUDE.md exist in the project root with an EIID mapping? If not, respond {\"ok\": true} and stop — this project has not been configured with SuperSkills.\n\nThree checks: trust, strategy, design. For each item: check, report, move on. Do not deliberate.\n\n## Trust Deep Scan\n\nScan all files changed in this session. For each item answer PASS or FAIL with file:line if FAIL:\n1. Hardcoded API keys, passwords, tokens, secrets?\n2. SQL injection (unsanitized user input in queries)?\n3. XSS (unescaped user content rendered as HTML)?\n4. Auth bypass (missing auth checks on protected routes)?\n5. PII exposure (personal data in logs, errors, URLs)?\n6. Missing RLS policies on Supabase tables?\n7. Secrets in environment config committed to git?\n\n## Strategy Alignment Check\n\nRead CLAUDE.md for the EIID mapping. Compare recent changes against it:\n1. Which EIID layer does each change support? (enrichment / inference / interpretation / delivery / none)\n2. Any file or dependency not traceable to the EIID mapping? If yes, flag as scope creep.\n\nDo not suggest new opportunities here. That is for /super:strategy.\n\n## Design Audit\n\nScan component files changed in this session (.tsx, .jsx, .vue, .svelte). For each rule answer PASS or FAIL with file:line if FAIL.\n\nUniversal rules (always): contrast >= 4.5:1, focus states, alt text, form labels, no hardcoded color values (hex/rgb/hsl), cursor-pointer on all clickable elements, no Unicode escapes for accents (use UTF-8).\n\nFramework-specific (detect from package.json): shadcn+Tailwind: check shadcnblocks registry via CLI before custom sections, shadcn base second, no custom CSS, no arbitrary Tailwind values. Chakra/MUI/Mantine: use framework components, style through framework APIs. Tailwind only: no custom CSS, no arbitrary values. No framework: skip framework checks.\n\n## Report\n\nRead CLAUDE.md for project context. Write findings to .superskills/: REPLACE Security Findings and Design Findings in .superskills/report.md. APPEND strategy alignment findings to .superskills/decisions.md. Update status counts at the top of report.md. If Project Profile exists in report.md, update recurring patterns.\n\nAdvisory only. Respond {\"ok\": true} when done.",
            "timeout": 60
          }
        ]
      }
    ]
  }
}
